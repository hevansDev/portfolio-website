(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[456],{5545:(e,t,n)=>{Promise.resolve().then(n.bind(n,6709))},6709:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>f});var r=n(5155),o=n(2115);let a=o.forwardRef(function(e,t){let{title:n,titleId:r,...a}=e;return o.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:t,"aria-labelledby":r},a),n?o.createElement("title",{id:r},n):null,o.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m2.25 15.75 5.159-5.159a2.25 2.25 0 0 1 3.182 0l5.159 5.159m-1.5-1.5 1.409-1.409a2.25 2.25 0 0 1 3.182 0l2.909 2.909m-18 3.75h16.5a1.5 1.5 0 0 0 1.5-1.5V6a1.5 1.5 0 0 0-1.5-1.5H3.75A1.5 1.5 0 0 0 2.25 6v12a1.5 1.5 0 0 0 1.5 1.5Zm10.5-11.25h.008v.008h-.008V8.25Zm.375 0a.375.375 0 1 1-.75 0 .375.375 0 0 1 .75 0Z"}))}),l=o.forwardRef(function(e,t){let{title:n,titleId:r,...a}=e;return o.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:t,"aria-labelledby":r},a),n?o.createElement("title",{id:r},n):null,o.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m16.862 4.487 1.687-1.688a1.875 1.875 0 1 1 2.652 2.652L10.582 16.07a4.5 4.5 0 0 1-1.897 1.13L6 18l.8-2.685a4.5 4.5 0 0 1 1.13-1.897l8.932-8.931Zm0 0L19.5 7.125M18 14v4.75A2.25 2.25 0 0 1 15.75 21H5.25A2.25 2.25 0 0 1 3 18.75V8.25A2.25 2.25 0 0 1 5.25 6H10"}))});var i=n(639);let s=o.forwardRef(function(e,t){let{title:n,titleId:r,...a}=e;return o.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:t,"aria-labelledby":r},a),n?o.createElement("title",{id:r},n):null,o.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m15 11.25-3-3m0 0-3 3m3-3v7.5M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"}))}),c=o.forwardRef(function(e,t){let{title:n,titleId:r,...a}=e;return o.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:t,"aria-labelledby":r},a),n?o.createElement("title",{id:r},n):null,o.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m9 12.75 3 3m0 0 3-3m-3 3v-7.5M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"}))}),d=o.forwardRef(function(e,t){let{title:n,titleId:r,...a}=e;return o.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:t,"aria-labelledby":r},a),n?o.createElement("title",{id:r},n):null,o.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m14.74 9-.346 9m-4.788 0L9.26 9m9.968-3.21c.342.052.682.107 1.022.166m-1.022-.165L18.16 19.673a2.25 2.25 0 0 1-2.244 2.077H8.084a2.25 2.25 0 0 1-2.244-2.077L4.772 5.79m14.456 0a48.108 48.108 0 0 0-3.478-.397m-12 .562c.34-.059.68-.114 1.022-.165m0 0a48.11 48.11 0 0 1 3.478-.397m7.5 0v-.916c0-1.18-.91-2.164-2.09-2.201a51.964 51.964 0 0 0-3.32 0c-1.18.037-2.09 1.022-2.09 2.201v.916m7.5 0a48.667 48.667 0 0 0-7.5 0"}))});function u(e){let{index:t,annotation:{title:n,description:o,fillStyle:a},onChange:l,moveAnnotation:i,removeAnnotation:u}=e;return(0,r.jsx)("div",{className:"w-full bg-white shadow sm:rounded-lg",children:(0,r.jsxs)("div",{className:"px-4 py-5 sm:p-6",children:[(0,r.jsxs)("div",{className:"flex justify-between",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("span",{className:"inline-block w-5 h-5 align-text-bottom rounded",style:{backgroundColor:a}}),(0,r.jsxs)("h3",{className:"inline-block pl-2 text-base font-semibold text-gray-900",children:["Annotation #",t+1]})]}),(0,r.jsxs)("div",{className:"flex space-x-4",children:[(0,r.jsxs)("button",{type:"button",onClick:()=>i("up"),className:"text-gray-400 bg-white rounded-md hover:text-gray-500 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2",children:[(0,r.jsx)("span",{className:"sr-only",children:"Close"}),(0,r.jsx)(s,{"aria-hidden":"true",className:"size-6"})]}),(0,r.jsxs)("button",{type:"button",onClick:()=>i("down"),className:"text-gray-400 bg-white rounded-md hover:text-gray-500 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2",children:[(0,r.jsx)("span",{className:"sr-only",children:"Close"}),(0,r.jsx)(c,{"aria-hidden":"true",className:"size-6"})]}),(0,r.jsxs)("button",{type:"button",onClick:()=>u(),className:"text-gray-400 bg-white rounded-md hover:text-gray-500 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2",children:[(0,r.jsx)("span",{className:"sr-only",children:"Close"}),(0,r.jsx)(d,{"aria-hidden":"true",className:"size-6"})]})]})]}),(0,r.jsxs)("div",{className:"max-w-xl mt-2 text-sm text-gray-500",children:[(0,r.jsx)("div",{className:"mt-2",children:(0,r.jsx)("input",{id:"stickerName",name:"stickerName",type:"text",placeholder:"Sticker name",value:n,onChange:e=>l("title",e.target.value),className:"block w-full rounded-md border-0 py-1.5 text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 placeholder:text-gray-400 focus:ring-2 focus:ring-inset focus:ring-indigo-600 sm:text-sm/6"})}),(0,r.jsx)("div",{className:"mt-2",children:(0,r.jsx)("textarea",{id:"description",name:"description",placeholder:"Add the story behind your sticker here, as well as anything else you want like other people to know about it!",value:o,onChange:e=>l("description",e.target.value),className:"block w-full rounded-md border-0 py-1.5 text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 placeholder:text-gray-400 focus:ring-2 focus:ring-inset focus:ring-indigo-600 sm:text-sm/6",rows:4})})]})]})})}let h=["rgba(239,68,68,0.5)","rgba(234,88,12,0.5)","rgba(5,150,105,0.5)","rgba(13,148,136,0.5)","rgba(14,165,233,0.5)","rgba(139,92,246,0.5)","rgba(168,85,247,0.5)","rgba(225,29,72,0.5)","rgba(219,39,119,0.5)","rgba(232,121,249,0.5)","rgba(77,124,15,0.5)","rgba(52,211,153,0.5)","rgba(29,78,216,0.5)","rgba(255, 0, 0, 0.5)"];function g(e){let{img:t}=e,n=(0,o.useRef)(null),[a,l]=(0,o.useState)([]),[s,c]=(0,o.useState)(null),[d,g]=(0,o.useState)(null),[f,m]=(0,o.useState)(null),[x,y]=(0,o.useState)({...t}),p=(e,t)=>{y(n=>({...n,annotations:[...n.annotations,{title:"",description:"",fillStyle:t,polygon:e}]}))},v=e=>{y(t=>({...t,annotations:t.annotations.filter((t,n)=>n!==e)}))},w=e=>{y(t=>({...t,title:e}))},b=(e,t,n)=>{y(r=>({...r,annotations:r.annotations.map((r,o)=>o===e?{...r,[t]:n}:r)}))},j=(e,t)=>{let n="up"===t?e-1:e+1;n<0||n>=x.annotations.length||y(t=>{let r=[...t.annotations];return[r[e],r[n]]=[r[n],r[e]],{...t,annotations:r}})},k=e=>{if(!n.current||!s)return{x:0,y:0};let t=n.current.getBoundingClientRect();return{x:(e.clientX-t.left)*(s.canvas.width/t.width),y:(e.clientY-t.top)*(s.canvas.height/t.height)}},N=()=>{let e=document.createElement("a"),t=new Blob([JSON.stringify(x)],{type:"application/json"});e.href=URL.createObjectURL(t),e.download="annotations.json",e.click(),URL.revokeObjectURL(e.href)};(0,o.useEffect)(()=>{let e=n.current;if(!e)return;let t=e.getContext("2d");if(!t)return;let r=new Image;r.src=x.src,r.onload=()=>{e.width=r.width,e.height=r.height,t.drawImage(r,0,0,e.width,e.height),c(t),g(r)}},[x.src]);let C=(e,t)=>{let{x:n,y:r}=t,o=(0,i.UQ)(e);e.fillStyle="white",e.strokeStyle="white",e.fillRect(n-2,r-2,o,o),e.moveTo(n,r)};(0,o.useEffect)(()=>{if(!n.current||!s||!d)return;let e=(e,t,n)=>{e.lineWidth=(0,i.UQ)(e)/6,e.strokeStyle="white",e.lineCap="square",e.beginPath();let{polygon:r}=t;for(let t=0;t<r.length;t++)0==t?e.moveTo(r[t].x,r[t].y):e.lineTo(r[t].x,r[t].y),n||C(e,r[t]);n&&(e.lineTo(r[0].x,r[0].y),e.closePath(),e.fillStyle=t.fillStyle,e.fill(),e.strokeStyle="blue"),e.stroke()};for(let t of(null==s||s.drawImage(d,0,0,s.canvas.width,s.canvas.height),x.annotations))e(s,t,!0);e(s,{polygon:a,fillStyle:""},!1),(e=>{if(!f)return;C(e,f);let t=a.at(-1);t&&(console.log(t),e.lineWidth=(0,i.UQ)(e)/6,e.strokeStyle="white",e.lineCap="square",e.beginPath(),e.moveTo(f.x,f.y),e.lineTo(t.x,t.y),e.stroke())})(s)},[f,a,x.annotations,s,d]);let E=()=>{if(a.length<=2){alert("Your polygon must have at least 3 points.");return}p(a,h[x.annotations.length%h.length]),l([])},L=e=>{if(!n.current||!s)return;if(!0===e.ctrlKey){E(),e.preventDefault();return}if(2===e.button){l(a.slice(0,-1));return}let t=k(e);if(a.length>0&&t.x==a.at(-1).x&&t.y==a.at(-1).y)return;let r=(0,i.UQ)(s)+30;if(void 0!==a[0]&&(0,i.cK)(a[0],t)<r){E();return}if((0,i.UP)(a,t)){alert("The line you are drawing intersects another line in your polygon.");return}l([...a,t])},S=e=>{m(k(e))};return(0,r.jsxs)("div",{className:"flex items-center justify-center w-screen h-screen p-4 space-x-4",children:[(0,r.jsx)("div",{className:"w-3/4",children:(0,r.jsx)("canvas",{className:"w-full cursor-crosshair",ref:n,onMouseDown:e=>L(e),onContextMenu:e=>e.preventDefault(),onMouseMove:e=>S(e),onMouseLeave:()=>m(null)})}),0===x.annotations.length?(0,r.jsxs)("div",{className:"flex flex-col items-center justify-center w-1/4 h-full space-y-2 text-center",children:[(0,r.jsx)("p",{children:"Gonna be honest, this is designed for desktop. If you're on mobile, your mileage may vary."}),(0,r.jsx)("p",{children:"Click to draw a point on your image. Right-click to undo the last point. Press CTRL+click or click the first point to close your shape."}),(0,r.jsx)("p",{children:"Once you complete a shape, you'll see an annotation display here. Each annotation gets filled with a random colour."}),(0,r.jsx)("p",{children:"If you have multiple annotations, the up and down arrows can change the “layering” order. If a user clicks on an overlapping annotation, annotation earliest in the list will be read."})]}):(0,r.jsxs)("div",{className:"flex flex-col items-center w-1/4 h-full py-2 space-y-3 overflow-y-auto",children:[x.annotations.map((e,t)=>(0,r.jsx)(u,{index:t,annotation:e,moveAnnotation:e=>j(t,e),removeAnnotation:()=>v(t),onChange:(e,n)=>b(t,e,n)},t)),(0,r.jsx)("div",{className:"w-full mt-5",children:(0,r.jsx)("button",{type:"button",className:"w-full px-3 py-2 text-sm font-semibold text-white bg-indigo-600 rounded-md shadow-sm hover:bg-indigo-500 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-indigo-600",onClick:()=>{let e=prompt("Enter a title for this annotation. For example: 'my work MacBook'.");w(null!=e?e:"My stickers!"),N()},children:"Save annotations"})})]})]})}function f(){let[e,t]=(0,o.useState)(null),n=e=>{var n,r;let o=new FileReader;if(!(null===(n=e.target.files)||void 0===n?void 0:n[0])){alert("No file selected!");return}o.readAsDataURL(null===(r=e.target.files)||void 0===r?void 0:r[0]),o.onload=e=>{var n;(null===(n=e.target)||void 0===n?void 0:n.result)&&t({src:e.target.result,title:"New Image",annotations:[]})},o.onerror=e=>{console.error(e),alert("An error occurred while reading the file.")}},i=e=>{var n,r;let o=new FileReader;if(!(null===(n=e.target.files)||void 0===n?void 0:n[0])){alert("No file selected!");return}o.readAsText(null===(r=e.target.files)||void 0===r?void 0:r[0]),o.onload=e=>{var n;if(null===(n=e.target)||void 0===n?void 0:n.result)try{t(JSON.parse(e.target.result))}catch(e){console.error(e),alert("An error occurred while reading the file.")}},o.onerror=e=>{console.error(e),alert("An error occurred while reading the file.")}};return e?(0,r.jsx)(g,{img:e}):(0,r.jsx)("div",{className:"flex flex-row items-center justify-center w-screen h-screen",children:(0,r.jsxs)("div",{className:"w-4/12 space-y-3 text-center text-gray-900",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("h1",{className:"text-3xl font-semibold",children:"Click-a-Sticker! Creator"}),(0,r.jsx)("p",{children:"Create annotated images to show off your laptop stickers! \uD83C\uDFA8"})]}),(0,r.jsx)("input",{id:"newImage",type:"file",accept:"image/*",onChange:e=>n(e),className:"hidden"}),(0,r.jsx)("input",{id:"existingFile",type:"file",accept:"application/json",onChange:e=>i(e),className:"hidden"}),(0,r.jsxs)("div",{className:"flex space-x-2",children:[(0,r.jsxs)("button",{onClick:()=>{var e;return null===(e=document.getElementById("newImage"))||void 0===e?void 0:e.click()},type:"button",className:"relative block w-full p-12 text-center border-2 border-gray-500 border-dashed rounded-lg hover:border-gray-700 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2",children:[(0,r.jsx)(a,{className:"mx-auto text-gray-600 size-12"}),(0,r.jsx)("span",{className:"block mt-2 text-sm font-semibold text-gray-900",children:"Select an image and annotate your stickers!"})]}),(0,r.jsxs)("button",{onClick:()=>{var e;return null===(e=document.getElementById("existingFile"))||void 0===e?void 0:e.click()},type:"button",className:"relative block w-full p-12 text-center border-2 border-gray-500 border-dashed rounded-lg hover:border-gray-700 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2",children:[(0,r.jsx)(l,{className:"mx-auto text-gray-600 size-12"}),(0,r.jsx)("span",{className:"block mt-2 text-sm font-semibold text-gray-900",children:"Edit an already annotated image!"})]})]}),(0,r.jsxs)("div",{children:[(0,r.jsxs)("p",{children:["Other, better solutions to do this probably exist, but I wanted to make something from scratch to get to grips with ",(0,r.jsx)("code",{children:"canvas"}),"."]}),(0,r.jsxs)("p",{children:["Some silly little code by"," ",(0,r.jsx)("a",{href:"https://cowsay.io",className:"underline",children:"Leo"}),"."]})]})]})})}},639:(e,t,n)=>{"use strict";n.d(t,{UP:()=>a,UQ:()=>l,cK:()=>o});let r=(e,t,n,r)=>{let o=t.x-e.x,a=t.y-e.y,l=r.x-n.x,i=r.y-n.y,s=(-a*(e.x-n.x)+o*(e.y-n.y))/(-l*a+o*i),c=(l*(e.y-n.y)-i*(e.x-n.x))/(-l*a+o*i);return s>=0&&s<=1&&c>=0&&c<=1},o=(e,t)=>Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2)),a=(e,t)=>{if(e.length<3)return!1;let n={x:0,y:0},o={x:0,y:0},a={...e.at(-1)},l={...t};for(let t=0;t<e.length-1;t++)if(n={...e[t]},((o={...e[t+1]}).x!==a.x||o.y!==a.y)&&(n.x!==l.x||n.y!==l.y)&&r(n,o,a,l))return!0;return!1},l=e=>Math.round(e.canvas.height/100)}},e=>{var t=t=>e(e.s=t);e.O(0,[441,517,358],()=>t(5545)),_N_E=e.O()}]);